webpackJsonp([17],{115:function(t,e,s){var a=s(3)(s(626),s(627),null,null);t.exports=a.exports},626:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s(6),i=function(t){return t&&t.__esModule?t:{default:t}}(a);e.default={name:"task-diff",data:function(){var t=this;return{modalinfo:!1,taska:{},taskb:{},buginter:[],bugunion:[],taskdata:[],tablecol:[{type:"selection",width:40,align:"center"},{title:"等级",align:"center",width:80,sortable:!0,key:"bugrank",render:function(t,e){var s=e.row.bugrank;return t("Tag",{props:{type:"border",color:"高危"===s?"red":"中危"===s?"yellow":"低危"===s?"blue":"red"}},s)}},{title:"漏洞名称",align:"center",key:"bugname",sortable:!0},{title:"漏洞地址",key:"bugaddr",sortable:!0},{title:"状态",key:"bugstate",width:100,sortable:!0},{title:"创建时间",align:"center",key:"createdate",sortable:!0,width:120,render:function(t,e){return t("span",[t("Icon",{props:{type:"android-time"}}),t("span",i.default.formatdate(e.row.createdate))])}},{title:"操作",align:"center",width:80,key:"action",render:function(e,s){return e("div",[e("Button",{props:{type:"info",size:"small"},on:{click:function(){var e={id:s.row.bugid};t.$router.push({name:"bug_info",query:e})}}},"详情")])}}],showCurrentTableData:!0}},methods:{taskdiff:function(t,e){var s=this;this.$route.query.tida=t,this.$route.query.tidb=e,void 0!=t&&"null"!=t&&void 0!=e&&"null"!=e?i.default.ajax({method:"POST",action:"taskdiff",json:{tida:t,tidb:e}}).then(function(t){s.buginter=t.inter,s.bugunion=t.union}).catch(function(t){s.$Message.error(t)}):this.$Message.error("请选取两个目标任务。")},scantasksearch:function(t){var e=this;i.default.ajax({method:"POST",action:"scantasksearch",json:{page:1,keyword:t}}).then(function(t){e.taskdata=t.ret}).catch(function(t){e.$Message.error(t)})},taskselecta:function(t){var e=this;this.taskdata.forEach(function(s){s.task_id==t&&(e.taska=s)})},taskselectb:function(t){var e=this;this.taskdata.forEach(function(s){s.task_id==t&&(e.taskb=s)})},taskswitch:function(){var t=this.taskb;this.taskb=this.taska,this.taska=t,this.$route.query.tida=this.taska.task_id,this.$route.query.tidb=this.taskb.task_id,this.taskdata=[]},bugfinish:function(){var t=this;this.selectlist=[],this.$refs.selection1.getSelection().forEach(function(e){t.selectlist.push(e.bugid)}),this.$refs.selection2.getSelection().forEach(function(e){t.selectlist.push(e.bugid)}),i.default.ajax({method:"POST",action:"bugfinish",json:{selectlist:this.selectlist}}).then(function(e){t.$Message.info("确认修复！")}).catch(function(e){t.$Message.error(e)})},bugfalse:function(){var t=this;this.selectlist=[],this.$refs.selection1.getSelection().forEach(function(e){t.selectlist.push(e.bugid)}),this.$refs.selection2.getSelection().forEach(function(e){t.selectlist.push(e.bugid)}),i.default.ajax({method:"POST",action:"bugfalse",json:{selectlist:this.selectlist}}).then(function(e){t.$Message.info("确认忽略！")}).catch(function(e){t.$Message.error(e)})},bugdelete:function(){var t=this;this.selectlist=[],this.$refs.selection1.getSelection().forEach(function(e){t.selectlist.push(e.bugid)}),this.$refs.selection2.getSelection().forEach(function(e){t.selectlist.push(e.bugid)}),i.default.ajax({method:"POST",action:"bugdelete",json:{selectlist:this.selectlist}}).then(function(e){t.taskdiff(t.$route.query.tida,t.$route.query.tidb),t.$Message.info("删除成功！")}).catch(function(e){t.$Message.error(e)})},gettaskbyid:function(t){var e=this;i.default.ajax({method:"POST",action:"scantasksearch",json:{page:1,keyword:t}}).then(function(s){s.ret.forEach(function(s){s.task_id==t&&(e.taskb=s)})}).catch(function(t){e.$Message.error(t)})}},created:function(){var t=this.$route.query.tida,e=this.$route.query.tidb;void 0!=t&&"null"!=t&&void 0!=e&&"null"!=e?this.taskdiff(t,e):(this.gettaskbyid(e),this.modalinfo=!0)}}},627:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",[s("Card",[s("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.modalinfo=!0}}},[s("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n            重选任务\n        ")],1),t._v(" "),s("Button",{attrs:{type:"success",size:"large"},on:{click:t.bugfinish}},[s("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n            确认修复\n        ")],1),t._v(" "),s("Button",{attrs:{type:"warning",size:"large"},on:{click:t.bugfalse}},[s("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n            确认忽略\n        ")],1),t._v(" "),s("Button",{attrs:{type:"error",size:"large"},on:{click:t.bugdelete}},[s("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n            删除漏洞\n        ")],1)],1)],1),t._v(" "),s("Card",[s("p",{attrs:{slot:"title"},slot:"title"},[t._v("与源任务相同漏洞")]),t._v(" "),s("Table",{ref:"selection1",attrs:{stripe:"",border:"",size:"small",columns:t.tablecol,data:t.buginter}})],1),s("Card",[s("p",{attrs:{slot:"title"},slot:"title"},[t._v("本次新增漏洞")]),t._v(" "),s("Table",{ref:"selection2",attrs:{stripe:"",border:"",size:"small",columns:t.tablecol,data:t.bugunion}})],1),t._v(" "),s("Modal",{attrs:{styles:{top:"30px"},okText:"对比"},on:{"on-ok":function(e){t.taskdiff(t.taska.task_id,t.taskb.task_id)}},model:{value:t.modalinfo,callback:function(e){t.modalinfo=e},expression:"modalinfo"}},[s("Row",[s("Col",{attrs:{lg:10}},[s("Card",[s("p",{attrs:{slot:"title"},slot:"title"},[t._v("源任务")]),t._v(" "),s("div",{staticStyle:{height:"150px"}},[s("ul",[s("li",{staticClass:"notwrap todolist-item"},[t._v("名称:"+t._s(t.taska.task_name))]),t._v(" "),s("li",{staticClass:"notwrap todolist-item"},[t._v("状态:"+t._s(t.taska.task_code))]),t._v(" "),s("li",{staticClass:"notwrap todolist-item"},[t._v("时间:"+t._s(t.taska.createdate))]),t._v(" "),s("li",{staticClass:"notwrap todolist-item"},[t._v("主机:"+t._s(t.taska.task_host))]),t._v(" "),s("li",{staticClass:"notwrap todolist-item"},[t._v("编号:"+t._s(t.taska.task_id))])])])]),t._v(" "),s("Select",{attrs:{remote:"",filterable:!0,transfer:!0,"remote-method":t.scantasksearch},on:{"on-change":t.taskselecta},model:{value:t.taska.task_id,callback:function(e){t.$set(t.taska,"task_id",e)},expression:"taska.task_id"}},t._l(t.taskdata,function(e){return s("Option",{attrs:{value:e.task_id}},[t._v(t._s(e.task_name)+"["+t._s(e.task_host)+"]")])}))],1),s("Col",{attrs:{lg:3}},[s("Button",{staticStyle:{margin:"100px 5px 5px 2px"},attrs:{type:"primary",shape:"circle"},on:{click:t.taskswitch}},[t._v("切换")])],1),s("Col",{attrs:{lg:10}},[s("Card",[s("p",{attrs:{slot:"title"},slot:"title"},[t._v("目标任务")]),t._v(" "),s("div",{staticStyle:{height:"150px"}},[s("ul",[s("li",{staticClass:"notwrap todolist-item"},[t._v("名称:"+t._s(t.taskb.task_name))]),t._v(" "),s("li",{staticClass:"notwrap todolist-item"},[t._v("状态:"+t._s(t.taskb.task_code))]),t._v(" "),s("li",{staticClass:"notwrap todolist-item"},[t._v("时间:"+t._s(t.taskb.createdate))]),t._v(" "),s("li",{staticClass:"notwrap todolist-item"},[t._v("主机:"+t._s(t.taskb.task_host))]),t._v(" "),s("li",{staticClass:"notwrap todolist-item"},[t._v("编号:"+t._s(t.taskb.task_id))])])])]),t._v(" "),s("Select",{attrs:{remote:"",filterable:!0,transfer:!0,"remote-method":t.scantasksearch},on:{"on-change":t.taskselectb},model:{value:t.taskb.task_id,callback:function(e){t.$set(t.taskb,"task_id",e)},expression:"taskb.task_id"}},t._l(t.taskdata,function(e){return s("Option",{attrs:{value:e.task_id}},[t._v(t._s(e.task_name)+"["+t._s(e.task_host)+"]")])}))],1)],1)],1)],1)},staticRenderFns:[]}}});