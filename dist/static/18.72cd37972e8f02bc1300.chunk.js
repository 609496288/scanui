webpackJsonp([18],{120:function(t,e,a){var s=a(3)(a(647),a(648),null,null);t.exports=s.exports},647:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(6),n=function(t){return t&&t.__esModule?t:{default:t}}(s);e.default={name:"buglist-table",data:function(){var t=this;return{modalinfo:!1,current:1,total:100,projectname:sessionStorage.projectname,projectid:sessionStorage.projectid,tasklist:[],searchdata:"",selectlist:[],buginfo:{},bugdata:[],tablehead:[{type:"selection",width:60,align:"center"},{title:"等级",align:"center",width:80,sortable:!0,key:"bugrank",render:function(t,e){var a=e.row.bugrank;return t("Tag",{props:{type:"border",color:"高危"===a?"red":"中危"===a?"yellow":"低危"===a?"blue":"red"}},a)}},{title:"漏洞名称",key:"bugname"},{title:"漏洞地址",key:"bugaddr"},{title:"漏洞状态",align:"center",key:"bugstate",sortable:!0,width:110},{title:"更新时间",align:"center",key:"updatedate",sortable:!0,width:180,render:function(t,e){return t("span",[t("Icon",{props:{type:"android-time"}}),t("span",n.default.formatdate(e.row.updatedate))])}},{title:"操作",align:"center",width:120,key:"action",render:function(e,a){return e("div",[e("Button",{props:{type:"info",size:"small"},on:{click:function(){var e={id:a.row.bugid};t.$router.push({name:"bug_info",query:e})}}},"详情"),e("Button",{props:{type:"primary",size:"small"},on:{click:function(){var e={id:a.row.bugid};t.$router.push({name:"bug_edit",params:{isedit:!0},query:e})}}},"编辑")])}}],showCurrentTableData:!0}},methods:{bugsearch:function(t){var e=this;n.default.ajax({method:"POST",action:"bugsearch",json:{page:t,history:!1,keyword:this.searchdata}}).then(function(t){e.bugdata=t.ret,e.total=t.total}).catch(function(t){e.$Message.error(t)})},bugfinish:function(){var t=this,e=this.$refs.selection.getSelection();this.selectlist=[];for(var a in e){this.selectlist.push(e[a].bugid);for(var s in this.bugdata)e[a].bugid==this.bugdata[s].bugid&&(this.bugdata[s].bugstate="已修复")}n.default.ajax({method:"POST",action:"bugfinish",json:{selectlist:this.selectlist}}).then(function(e){t.bugsearch(1),t.$Message.info("确认修复！")}).catch(function(e){t.$Message.error(e)})},bugfalse:function(){var t=this,e=this.$refs.selection.getSelection();this.selectlist=[];for(var a in e){this.selectlist.push(e[a].bugid);for(var s in this.bugdata)e[a].bugid==this.bugdata[s].bugid&&(this.bugdata[s].bugstate="已忽略")}n.default.ajax({method:"POST",action:"bugfalse",json:{selectlist:this.selectlist}}).then(function(e){t.bugsearch(1),t.$Message.info("确认忽略！")}).catch(function(e){t.$Message.error(e)})},bugadd:function(){this.$router.push({name:"bug_edit"})},uploadsuccess:function(t,e){this.taskinfo=[];for(var a=0;a<t.result.length;a++)this.taskinfo.push(t.result[a].fid)},bugimport:function(){var t=this;n.default.ajax({method:"POST",action:"bugimport",json:{fids:this.taskinfo}}).then(function(e){t.$Message.info("后台导入中。。。")}).catch(function(e){t.$Message.error(e)})}},created:function(){if(this.$route.params.isadd)return this.modalinfo=!0;"null"!=sessionStorage.projectid&&void 0!=sessionStorage.projectid?this.bugsearch(1):(this.$Message.error("请先选择当前系统"),this.$router.push({name:"project_index"}))}}},648:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("Dropdown",{staticStyle:{"margin-left":"20px"}},[a("Button",{attrs:{type:"primary",size:"large"},on:{click:t.bugadd}},[a("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n                新增漏洞\n            ")],1),t._v(" "),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",[a("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.modalinfo=!0}}},[a("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n                导入漏洞\n                ")],1)],1)],1)],1),t._v(" "),a("Button",{attrs:{type:"success",size:"large"},on:{click:t.bugfinish}},[a("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n            确认修复\n        ")],1),t._v(" "),a("Button",{attrs:{type:"warning",size:"large"},on:{click:t.bugfalse}},[a("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n            确认忽略\n        ")],1),t._v(" "),a("Input",{staticStyle:{width:"300px"},attrs:{slot:"extra",icon:"search",placeholder:"请输入ID,名称,地址搜索..."},on:{"on-click":function(e){t.bugsearch(1)}},nativeOn:{keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.bugsearch(1)}},slot:"extra",model:{value:t.searchdata,callback:function(e){t.searchdata=e},expression:"searchdata"}})],1),t._v(" "),a("Table",{ref:"selection",attrs:{stripe:"",border:"",columns:t.tablehead,data:t.bugdata}}),t._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"left"}},[t._v("共 "+t._s(t.total)+" 条")]),t._v(" "),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{"show-elevator":"",current:t.current,total:t.total,"page-size":30},on:{"on-change":t.bugsearch}})],1)]),t._v(" "),a("Modal",{attrs:{title:t.projectname,styles:{top:"30px"},okText:"导入"},on:{"on-ok":t.bugimport},model:{value:t.modalinfo,callback:function(e){t.modalinfo=e},expression:"modalinfo"}},[a("div",{staticClass:"margin-top-10"},[a("Card",[a("div",{staticClass:"height-400px"},[a("Upload",{attrs:{multiple:"",type:"drag",action:"/upload.php","on-success":t.uploadsuccess}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),t._v(" "),a("p",[t._v("上传报告文件")]),t._v(" "),a("pre",{domProps:{innerHTML:t._s("目前支持的报告格式：<br>nessus-csv,awvs-html<br>天融信-html,绿盟-html")}})],1)],1)])],1)])],1)},staticRenderFns:[]}}});