webpackJsonp([12],{126:function(t,e,a){var l=a(3)(a(661),a(662),null,null);t.exports=l.exports},661:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a(6),o=function(t){return t&&t.__esModule?t:{default:t}}(l);e.default={name:"vul-table",data:function(){var t=this;return{modalinfo:!1,current:1,total:100,searchdata:"",selectlist:[],rowinfo:{vulid:"",vulname:"",vulplan:"",vulrank:"",vulowasp:"",vulno:"",vuldesc:""},tabledata:[{vulid:"",vulname:"",vulplan:"",vulrank:"",vulowasp:"",vulno:"",vuldesc:""}],tablehead:[{type:"selection",width:60,align:"center"},{title:"等级",align:"center",key:"vulrank",width:80,sortable:!0,render:function(t,e){var a=e.row;return t("Tag",{props:{type:"border",color:"高危"===a.vulrank?"red":"中危"===a.vulrank?"yellow":"低危"===a.vulrank?"blue":"red"}},a.vulrank)}},{title:"漏洞名称",key:"vulname"},{title:"OWASP",align:"left",key:"vulowasp",sortable:!0},{title:"漏洞编号",align:"center",key:"vulno",sortable:!0},{title:"操作",align:"center",width:100,key:"action",render:function(e,a){return e("Button",{props:{type:"primary"},on:{click:function(){t.vulshow(a.index,!1)}}},"编辑")}}],showCurrentTableData:!1}},methods:{vulsearch:function(t){var e=this;o.default.ajax({method:"POST",action:"vulsearch",json:{page:t,keyword:this.searchdata}}).then(function(t){e.tabledata=t.ret,e.total=t.total}).catch(function(t){e.$Message.error(t)})},vulshow:function(t,e){this.rowinfo=e?{}:this.tabledata[t],this.modalinfo=!0},vuldelete:function(){var t=this,e=this.$refs.selection.getSelection();this.selectlist=[];for(var a in e){this.selectlist.push(e[a].vulid);for(var l in this.tabledata)e[a].vulid==this.tabledata[l].vulid&&this.tabledata.splice(l,1)}o.default.ajax({method:"POST",action:"vuldelete",json:{selectlist:this.selectlist}}).then(function(e){t.$Message.info("删除成功！")}).catch(function(e){t.$Message.error(e)})},vuledit:function(){var t=this;o.default.ajax({method:"POST",action:"vuledit",json:this.rowinfo}).then(function(e){e.created&&t.tabledata.unshift(e),t.$Message.info(e.vulname+" 更新成功！")}).catch(function(e){t.$Message.error(e)})}},created:function(){this.vulsearch(1)}}},662:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.vulshow(0,!0)}}},[a("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n            新增漏洞\n        ")],1),t._v(" "),a("Poptip",{attrs:{confirm:"",placement:"bottom",title:"确认删除？"},on:{"on-ok":t.vuldelete}},[a("Button",{attrs:{type:"error",size:"large"}},[a("Icon",{attrs:{type:"ios-download-outline"}}),t._v("\n            删除漏洞\n            ")],1)],1),t._v(" "),a("Input",{staticStyle:{width:"300px"},attrs:{slot:"extra",icon:"search",placeholder:"请输入漏洞名或漏洞编号进行搜索..."},on:{"on-click":function(e){t.vulsearch(1)}},nativeOn:{keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.vulsearch(1)}},slot:"extra",model:{value:t.searchdata,callback:function(e){t.searchdata=e},expression:"searchdata"}})],1),t._v(" "),a("Table",{ref:"selection",attrs:{stripe:"",border:"",size:"small",columns:t.tablehead,data:t.tabledata}}),t._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"left"}},[t._v("共 "+t._s(t.total)+" 条")]),t._v(" "),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{"show-elevator":"",current:t.current,total:t.total,"page-size":30},on:{"on-change":t.vulsearch}})],1)]),t._v(" "),a("Modal",{attrs:{title:"漏洞编辑",styles:{top:"30px"},okText:"保存"},on:{"on-ok":t.vuledit},model:{value:t.modalinfo,callback:function(e){t.modalinfo=e},expression:"modalinfo"}},[a("Form",{attrs:{model:t.rowinfo,"label-width":80}},[a("FormItem",{attrs:{label:"漏洞名称"}},[a("Input",{attrs:{type:"text"},model:{value:t.rowinfo.vulname,callback:function(e){t.$set(t.rowinfo,"vulname",e)},expression:"rowinfo.vulname"}})],1),t._v(" "),a("FormItem",{attrs:{label:"漏洞等级"}},[a("Select",{model:{value:t.rowinfo.vulrank,callback:function(e){t.$set(t.rowinfo,"vulrank",e)},expression:"rowinfo.vulrank"}},[a("Option",{attrs:{value:"紧急"}},[t._v("紧急")]),t._v(" "),a("Option",{attrs:{value:"高危"}},[t._v("高危")]),t._v(" "),a("Option",{attrs:{value:"中危"}},[t._v("中危")]),t._v(" "),a("Option",{attrs:{value:"低危"}},[t._v("低危")])],1)],1),t._v(" "),a("FormItem",{attrs:{label:"OWASP"}},[a("Select",{attrs:{filterable:""},model:{value:t.rowinfo.vulowasp,callback:function(e){t.$set(t.rowinfo,"vulowasp",e)},expression:"rowinfo.vulowasp"}},[a("Option",{attrs:{value:"A1:2017-注入"}},[t._v("A1:2017-注入")]),t._v(" "),a("Option",{attrs:{value:"A2:2017-失效的身份认证和会话管理"}},[t._v("A2:2017-失效的身份认证和会话管理")]),t._v(" "),a("Option",{attrs:{value:"A3:2017-敏感信息泄露"}},[t._v("A3:2017-敏感信息泄露")]),t._v(" "),a("Option",{attrs:{value:"A4:2017-XML外部实体(XXE)"}},[t._v("A4:2017-XML外部实体(XXE)")]),t._v(" "),a("Option",{attrs:{value:"A5:2017-失效的访问控制"}},[t._v("A5:2017-失效的访问控制")]),t._v(" "),a("Option",{attrs:{value:"A6:2017-安全配置错误"}},[t._v("A6:2017-安全配置错误")]),t._v(" "),a("Option",{attrs:{value:"A7:2017-跨站脚本(XSS)"}},[t._v("A7:2017-跨站脚本(XSS)")]),t._v(" "),a("Option",{attrs:{value:"A8:2017-不安全的反序列化"}},[t._v("A8:2017-不安全的反序列化")]),t._v(" "),a("Option",{attrs:{value:"A9:2017-使用含有已知漏洞的组件"}},[t._v("A9:2017-使用含有已知漏洞的组件")]),t._v(" "),a("Option",{attrs:{value:"A10:2017-不足的日志记录和监控"}},[t._v("A10:2017-不足的日志记录和监控")])],1)],1),t._v(" "),a("FormItem",{attrs:{label:"漏洞编号"}},[a("Input",{attrs:{type:"text"},model:{value:t.rowinfo.vulno,callback:function(e){t.$set(t.rowinfo,"vulno",e)},expression:"rowinfo.vulno"}})],1),t._v(" "),a("FormItem",{attrs:{label:"漏洞详情"}},[a("Input",{attrs:{type:"textarea"},model:{value:t.rowinfo.vuldesc,callback:function(e){t.$set(t.rowinfo,"vuldesc",e)},expression:"rowinfo.vuldesc"}})],1),t._v(" "),a("FormItem",{attrs:{label:"修复建议"}},[a("Input",{attrs:{type:"textarea"},model:{value:t.rowinfo.vulplan,callback:function(e){t.$set(t.rowinfo,"vulplan",e)},expression:"rowinfo.vulplan"}})],1)],1)],1)],1)},staticRenderFns:[]}}});